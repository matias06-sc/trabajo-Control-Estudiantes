name: Django CI

on:
  push:
    branches: [ "crud-estudiantes" ]
  pull_request:
    branches: [ "crud-estudiantes" ]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout del c칩digo
        uses: actions/checkout@v3

      - name: Configurar Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.12'   # ajusta si usas otra versi칩n en tu proyecto

      - name: Instalar dependencias
        run: |
          python -m pip install --upgrade pip
          if [ -f requirements.txt ]; then pip install -r requirements.txt; fi
          pip install django

      # 游녢 Paso nuevo para ubicar manage.py
      - name: Verificar directorios
        run: |
          pwd
          ls -R

      # 丘멆잺 Por ahora no ponemos working-directory fijo
      # Una vez que veamos en el log d칩nde est치 manage.py,
      # ajustamos la ruta aqu칤 mismo.
      - name: Migrar base de datos
        run: |
          python manage.py migrate --noinput

      - name: Ejecutar pruebas
        run: |
          python manage.py test
